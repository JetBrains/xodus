<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>BlobVault (xodus-openAPI API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../jquery/jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="../../../jquery/jquery-ui.min.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="BlobVault (xodus-openAPI API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":6,"i1":10,"i2":10,"i3":6,"i4":10,"i5":6,"i6":6,"i7":6,"i8":10,"i9":10,"i10":6,"i11":10,"i12":10,"i13":6,"i14":10,"i15":10,"i16":10,"i17":6,"i18":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">jetbrains.exodus.entitystore</a></div>
<h2 title="Class BlobVault" class="title">Class BlobVault</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>jetbrains.exodus.entitystore.BlobVault</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../backup/Backupable.html" title="interface in jetbrains.exodus.backup">Backupable</a></code>, <code><a href="BlobHandleGenerator.html" title="interface in jetbrains.exodus.entitystore">BlobHandleGenerator</a></code></dd>
</dl>
<hr>
<pre>public abstract class <span class="typeNameLabel">BlobVault</span>
extends java.lang.Object
implements <a href="BlobHandleGenerator.html" title="interface in jetbrains.exodus.entitystore">BlobHandleGenerator</a>, <a href="../backup/Backupable.html" title="interface in jetbrains.exodus.backup">Backupable</a></pre>
<div class="block"><code>BlobVault</code> is base class describing interface to <a href="https://en.wikipedia.org/wiki/Binary_large_object">
 binary large objects (BLOBs)</a> used internally by implementation of <a href="PersistentEntityStore.html" title="interface in jetbrains.exodus.entitystore">PersistentEntityStore</a>.

 <p>Blob values are identified by blob <i>handles</i> generated by <a href="BlobHandleGenerator.html" title="interface in jetbrains.exodus.entitystore">BlobHandleGenerator</a>.
 <code>PersistentEntityStore</code> encapsulates mapping of <a href="Entity.html" title="interface in jetbrains.exodus.entitystore">Entity</a> blob values to blob handles, whereas
 <code>BlobVault</code> allows to read/write blob values identified by blob handles. Blob values are immutable, i.e.
 blob value by a blob handle cannot be changed, only deleted.

 <p><code>BlobVault</code> allows to get string content of blob for method <a href="Entity.html#getBlobString(java.lang.String)">Entity.getBlobString(String)</a>.
 In order to reduce CPU consumption on transformation of binary content to UTF-8 strings, <code>BlobVault</code>
 encapsulates a cache of blob strings.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="PersistentEntityStore.html" title="interface in jetbrains.exodus.entitystore"><code>PersistentEntityStore</code></a>, 
<a href="BlobHandleGenerator.html" title="interface in jetbrains.exodus.entitystore"><code>BlobHandleGenerator</code></a></dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static org.slf4j.Logger</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#logger">logger</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="fields.inherited.from.class.jetbrains.exodus.entitystore.BlobHandleGenerator">
<!--   -->
</a>
<h3>Fields inherited from interface&nbsp;jetbrains.exodus.entitystore.<a href="BlobHandleGenerator.html" title="interface in jetbrains.exodus.entitystore">BlobHandleGenerator</a></h3>
<code><a href="BlobHandleGenerator.html#IMMUTABLE">IMMUTABLE</a></code></li>
</ul>
</li>
</ul>
</section>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier</th>
<th class="colSecond" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected </code></td>
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(jetbrains.exodus.entitystore.BlobVault)">BlobVault</a></span>&#8203;(@NotNull <a href="BlobVault.html" title="class in jetbrains.exodus.entitystore">BlobVault</a>&nbsp;source)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected </code></td>
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(jetbrains.exodus.entitystore.PersistentEntityStoreConfig)">BlobVault</a></span>&#8203;(@NotNull <a href="PersistentEntityStoreConfig.html" title="class in jetbrains.exodus.entitystore">PersistentEntityStoreConfig</a>&nbsp;config)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>abstract void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#clear()">clear</a></span>()</code></th>
<td class="colLast">
<div class="block">Is called on <a href="PersistentEntityStore.html#clear()">PersistentEntityStore.clear()</a>.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>jetbrains.exodus.util.ByteArraySizedInputStream</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#cloneFile(java.io.File)">cloneFile</a></span>&#8203;(@NotNull java.io.File&nbsp;file)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>jetbrains.exodus.util.ByteArraySizedInputStream</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#cloneStream(java.io.InputStream,boolean)">cloneStream</a></span>&#8203;(@NotNull java.io.InputStream&nbsp;source,
           boolean&nbsp;closeSource)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>abstract void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#close()">close</a></span>()</code></th>
<td class="colLast">
<div class="block">Is called on <a href="EntityStore.html#close()">EntityStore.close()</a>.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>java.io.ByteArrayOutputStream</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#copyStream(java.io.InputStream,boolean)">copyStream</a></span>&#8203;(@NotNull java.io.InputStream&nbsp;source,
          boolean&nbsp;closeSource)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>abstract boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#delete(long)">delete</a></span>&#8203;(long&nbsp;blobHandle)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>abstract void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#flushBlobs(jetbrains.exodus.core.dataStructures.hash.LongHashMap,jetbrains.exodus.core.dataStructures.hash.LongHashMap,jetbrains.exodus.core.dataStructures.hash.LongHashMap,jetbrains.exodus.core.dataStructures.hash.LongSet,jetbrains.exodus.env.Environment)">flushBlobs</a></span>&#8203;(@Nullable jetbrains.exodus.core.dataStructures.hash.LongHashMap&lt;java.io.InputStream&gt;&nbsp;blobStreams,
          @Nullable jetbrains.exodus.core.dataStructures.hash.LongHashMap&lt;java.nio.file.Path&gt;&nbsp;blobFiles,
          @Nullable jetbrains.exodus.core.dataStructures.hash.LongHashMap&lt;java.nio.file.Path&gt;&nbsp;tmpBlobFiles,
          @Nullable jetbrains.exodus.core.dataStructures.hash.LongSet&nbsp;deferredBlobsToDelete,
          @NotNull <a href="../env/Environment.html" title="interface in jetbrains.exodus.env">Environment</a>&nbsp;environment)</code></th>
<td class="colLast">
<div class="block">Method called by <a href="PersistentEntityStore.html" title="interface in jetbrains.exodus.entitystore">PersistentEntityStore</a> to flush blobs.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>abstract @NotNull <a href="BlobVaultItem.html" title="interface in jetbrains.exodus.entitystore">BlobVaultItem</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getBlob(long)">getBlob</a></span>&#8203;(long&nbsp;blobHandle)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getBlobKey(long)">getBlobKey</a></span>&#8203;(long&nbsp;blobHandle)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>@NotNull java.io.File</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getBlobLocation(long)">getBlobLocation</a></span>&#8203;(long&nbsp;blobHandle)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>abstract @Nullable java.io.InputStream</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getContent(long,jetbrains.exodus.env.Transaction,java.lang.Long)">getContent</a></span>&#8203;(long&nbsp;blobHandle,
          @NotNull <a href="../env/Transaction.html" title="interface in jetbrains.exodus.env">Transaction</a>&nbsp;txn,
          @Nullable java.lang.Long&nbsp;expectedLength)</code></th>
<td class="colLast">
<div class="block">Returns binary content of blob identified by specified blob handle as InputStream.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>java.io.BufferedInputStream</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getFileStream(java.io.File)">getFileStream</a></span>&#8203;(@NotNull java.io.File&nbsp;file)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>int</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getIdentity()">getIdentity</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>abstract long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getSize(long,jetbrains.exodus.env.Transaction)">getSize</a></span>&#8203;(long&nbsp;blobHandle,
       @NotNull <a href="../env/Transaction.html" title="interface in jetbrains.exodus.env">Transaction</a>&nbsp;txn)</code></th>
<td class="colLast">
<div class="block">Returns size of blob identified by specified blob handle in bytes.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code><a href="BlobVault.html" title="class in jetbrains.exodus.entitystore">BlobVault</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getSourceVault()">getSourceVault</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>@Nullable java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getStringContent(long,jetbrains.exodus.env.Transaction,java.lang.Long)">getStringContent</a></span>&#8203;(long&nbsp;blobHandle,
                @NotNull <a href="../env/Transaction.html" title="interface in jetbrains.exodus.env">Transaction</a>&nbsp;txn,
                @Nullable java.lang.Long&nbsp;expectedRawLength)</code></th>
<td class="colLast">
<div class="block">Returns string content of blob identified by specified blob handle.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>float</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getStringContentCacheHitRate()">getStringContentCacheHitRate</a></span>()</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>abstract boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#requiresTxn()">requiresTxn</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns <code>true</code> if <code>BlobVault</code> implementation requires <a href="../env/Transaction.html" title="interface in jetbrains.exodus.env">transaction</a> to
 flush blobs when <a href="StoreTransaction.html#flush()">StoreTransaction.flush()</a> or <a href="StoreTransaction.html#commit()">StoreTransaction.commit()</a> is called.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>abstract long</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#size()">size</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns amount of disk space occupied by the <code>BlobVault</code>.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.jetbrains.exodus.backup.Backupable">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;jetbrains.exodus.backup.<a href="../backup/Backupable.html" title="interface in jetbrains.exodus.backup">Backupable</a></h3>
<code><a href="../backup/Backupable.html#getBackupStrategy()">getBackupStrategy</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.jetbrains.exodus.entitystore.BlobHandleGenerator">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;jetbrains.exodus.entitystore.<a href="BlobHandleGenerator.html" title="interface in jetbrains.exodus.entitystore">BlobHandleGenerator</a></h3>
<code><a href="BlobHandleGenerator.html#nextHandle()">nextHandle</a></code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a id="logger">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>logger</h4>
<pre>protected static final&nbsp;org.slf4j.Logger logger</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(jetbrains.exodus.entitystore.BlobVault)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>BlobVault</h4>
<pre>protected&nbsp;BlobVault&#8203;(@NotNull
                    @NotNull <a href="BlobVault.html" title="class in jetbrains.exodus.entitystore">BlobVault</a>&nbsp;source)</pre>
</li>
</ul>
<a id="&lt;init&gt;(jetbrains.exodus.entitystore.PersistentEntityStoreConfig)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BlobVault</h4>
<pre>protected&nbsp;BlobVault&#8203;(@NotNull
                    @NotNull <a href="PersistentEntityStoreConfig.html" title="class in jetbrains.exodus.entitystore">PersistentEntityStoreConfig</a>&nbsp;config)</pre>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section>
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="getSourceVault()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSourceVault</h4>
<pre class="methodSignature">public&nbsp;<a href="BlobVault.html" title="class in jetbrains.exodus.entitystore">BlobVault</a>&nbsp;getSourceVault()</pre>
</li>
</ul>
<a id="getIdentity()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getIdentity</h4>
<pre class="methodSignature">public&nbsp;int&nbsp;getIdentity()</pre>
</li>
</ul>
<a id="getBlobLocation(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBlobLocation</h4>
<pre class="methodSignature">@NotNull
public&nbsp;@NotNull java.io.File&nbsp;getBlobLocation&#8203;(long&nbsp;blobHandle)</pre>
</li>
</ul>
<a id="getBlobKey(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBlobKey</h4>
<pre class="methodSignature">public&nbsp;java.lang.String&nbsp;getBlobKey&#8203;(long&nbsp;blobHandle)</pre>
</li>
</ul>
<a id="getBlob(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBlob</h4>
<pre class="methodSignature">@NotNull
public abstract&nbsp;@NotNull <a href="BlobVaultItem.html" title="interface in jetbrains.exodus.entitystore">BlobVaultItem</a>&nbsp;getBlob&#8203;(long&nbsp;blobHandle)</pre>
</li>
</ul>
<a id="delete(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>delete</h4>
<pre class="methodSignature">public abstract&nbsp;boolean&nbsp;delete&#8203;(long&nbsp;blobHandle)</pre>
</li>
</ul>
<a id="getContent(long,jetbrains.exodus.env.Transaction,java.lang.Long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getContent</h4>
<pre class="methodSignature">@Nullable
public abstract&nbsp;@Nullable java.io.InputStream&nbsp;getContent&#8203;(long&nbsp;blobHandle,
                                                         @NotNull
                                                         @NotNull <a href="../env/Transaction.html" title="interface in jetbrains.exodus.env">Transaction</a>&nbsp;txn,
                                                         @Nullable
                                                         @Nullable java.lang.Long&nbsp;expectedLength)</pre>
<div class="block">Returns binary content of blob identified by specified blob handle as InputStream.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>blobHandle</code> - blob handle</dd>
<dd><code>txn</code> - <a href="../env/Transaction.html" title="interface in jetbrains.exodus.env">Transaction</a> instance</dd>
<dd><code>expectedLength</code> - Expected size of content in bytes.
                       If sizes do not match <code>null</code> will be returned.
                       Can be <code>null</code> in such case content length verification will be bypassed.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>binary content of blob as InputStream</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="Entity.html#getBlob(java.lang.String)"><code>Entity.getBlob(String)</code></a></dd>
</dl>
</li>
</ul>
<a id="getSize(long,jetbrains.exodus.env.Transaction)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSize</h4>
<pre class="methodSignature">public abstract&nbsp;long&nbsp;getSize&#8203;(long&nbsp;blobHandle,
                             @NotNull
                             @NotNull <a href="../env/Transaction.html" title="interface in jetbrains.exodus.env">Transaction</a>&nbsp;txn)</pre>
<div class="block">Returns size of blob identified by specified blob handle in bytes.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>blobHandle</code> - blob handle</dd>
<dd><code>txn</code> - <a href="../env/Transaction.html" title="interface in jetbrains.exodus.env">Transaction</a> instance</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>size of blob in bytes</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="Entity.html#getBlobSize(java.lang.String)"><code>Entity.getBlobSize(String)</code></a></dd>
</dl>
</li>
</ul>
<a id="requiresTxn()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>requiresTxn</h4>
<pre class="methodSignature">public abstract&nbsp;boolean&nbsp;requiresTxn()</pre>
<div class="block">Returns <code>true</code> if <code>BlobVault</code> implementation requires <a href="../env/Transaction.html" title="interface in jetbrains.exodus.env">transaction</a> to
 flush blobs when <a href="StoreTransaction.html#flush()">StoreTransaction.flush()</a> or <a href="StoreTransaction.html#commit()">StoreTransaction.commit()</a> is called.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if <code>BlobVault</code> implementation requires <a href="../env/Transaction.html" title="interface in jetbrains.exodus.env">transaction</a></dd>
</dl>
</li>
</ul>
<a id="flushBlobs(jetbrains.exodus.core.dataStructures.hash.LongHashMap,jetbrains.exodus.core.dataStructures.hash.LongHashMap,jetbrains.exodus.core.dataStructures.hash.LongHashMap,jetbrains.exodus.core.dataStructures.hash.LongSet,jetbrains.exodus.env.Environment)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flushBlobs</h4>
<pre class="methodSignature">public abstract&nbsp;void&nbsp;flushBlobs&#8203;(@Nullable
                                @Nullable jetbrains.exodus.core.dataStructures.hash.LongHashMap&lt;java.io.InputStream&gt;&nbsp;blobStreams,
                                @Nullable
                                @Nullable jetbrains.exodus.core.dataStructures.hash.LongHashMap&lt;java.nio.file.Path&gt;&nbsp;blobFiles,
                                @Nullable
                                @Nullable jetbrains.exodus.core.dataStructures.hash.LongHashMap&lt;java.nio.file.Path&gt;&nbsp;tmpBlobFiles,
                                @Nullable
                                @Nullable jetbrains.exodus.core.dataStructures.hash.LongSet&nbsp;deferredBlobsToDelete,
                                @NotNull
                                @NotNull <a href="../env/Environment.html" title="interface in jetbrains.exodus.env">Environment</a>&nbsp;environment)
                         throws java.lang.Exception</pre>
<div class="block">Method called by <a href="PersistentEntityStore.html" title="interface in jetbrains.exodus.entitystore">PersistentEntityStore</a> to flush blobs. Three maps represent three
 ways of dealing with blob content: using streams, <code>java.io.File</code> instances and storing content
 of streams to the temporary directory before transaction commit. They naturally follow from
 the <a href="Entity.html" title="interface in jetbrains.exodus.entitystore">Entity</a> API, having two methods to set blob: <a href="Entity.html#setBlob(java.lang.String,java.io.InputStream)">Entity.setBlob(String, InputStream)</a>
 and <a href="Entity.html#setBlob(java.lang.String,java.io.File)">Entity.setBlob(String, File)</a>. The last map is used to keep copy  of streams into temporary vault
 storage before commit and then moving them into permanent vault store after commit to ensure durability of commit.

 <p>The set <code>deferredBlobsToDelete</code> contains blob handles of blobs that should be deleted after the
 transaction is finished. In most cases, these blobs cannot be deleted immediately without violating isolation
 transaction guarantees.
 <p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>blobStreams</code> - map of blob handles to InputStream instances</dd>
<dd><code>blobFiles</code> - map of blob handles to File instances</dd>
<dd><code>tmpBlobFiles</code> - map of blob handles to temporary files which are used to store content of input streams.</dd>
<dd><code>deferredBlobsToDelete</code> - set of blob handles of blobs that should be deleted after the transaction is finished</dd>
<dd><code>environment</code> - environment which contains current blob vault.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - something went wrong</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><code>LongHashMap</code>, 
<code>LongSet</code>, 
<a href="../env/Transaction.html" title="interface in jetbrains.exodus.env"><code>Transaction</code></a></dd>
</dl>
</li>
</ul>
<a id="size()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>size</h4>
<pre class="methodSignature">public abstract&nbsp;long&nbsp;size()</pre>
<div class="block">Returns amount of disk space occupied by the <code>BlobVault</code>. This value is rather "rough" since it does not
 take into consideration particular file system features of storage device.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>amount of disk space occupied by the <code>BlobVault</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="PersistentEntityStore.html#getUsableSpace()"><code>PersistentEntityStore.getUsableSpace()</code></a>, 
<code>IOUtil.getAdjustedFileLength(File)</code></dd>
</dl>
</li>
</ul>
<a id="clear()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>clear</h4>
<pre class="methodSignature">public abstract&nbsp;void&nbsp;clear()</pre>
<div class="block">Is called on <a href="PersistentEntityStore.html#clear()">PersistentEntityStore.clear()</a>.</div>
</li>
</ul>
<a id="close()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>close</h4>
<pre class="methodSignature">public abstract&nbsp;void&nbsp;close()</pre>
<div class="block">Is called on <a href="EntityStore.html#close()">EntityStore.close()</a>.</div>
</li>
</ul>
<a id="getStringContent(long,jetbrains.exodus.env.Transaction,java.lang.Long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStringContent</h4>
<pre class="methodSignature">@Nullable
public final&nbsp;@Nullable java.lang.String&nbsp;getStringContent&#8203;(long&nbsp;blobHandle,
                                                         @NotNull
                                                         @NotNull <a href="../env/Transaction.html" title="interface in jetbrains.exodus.env">Transaction</a>&nbsp;txn,
                                                         @Nullable
                                                         @Nullable java.lang.Long&nbsp;expectedRawLength)
                                                  throws java.io.IOException</pre>
<div class="block">Returns string content of blob identified by specified blob handle. String contents cache is used.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>blobHandle</code> - blob handle</dd>
<dd><code>txn</code> - <a href="../env/Transaction.html" title="interface in jetbrains.exodus.env">Transaction</a> instance</dd>
<dd><code>expectedRawLength</code> - Expected size of the blob in bytes.
                          If sizes do not match <code>null</code> will be returned.
                          Can be <code>null</code> in such case content length verification will be bypassed.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>string content of blob identified by specified blob handle</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if something went wrong</dd>
</dl>
</li>
</ul>
<a id="getStringContentCacheHitRate()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getStringContentCacheHitRate</h4>
<pre class="methodSignature">public final&nbsp;float&nbsp;getStringContentCacheHitRate()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>hit rate of string
 contents cache</dd>
</dl>
</li>
</ul>
<a id="copyStream(java.io.InputStream,boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>copyStream</h4>
<pre class="methodSignature">public final&nbsp;java.io.ByteArrayOutputStream&nbsp;copyStream&#8203;(@NotNull
                                                      @NotNull java.io.InputStream&nbsp;source,
                                                      boolean&nbsp;closeSource)
                                               throws java.io.IOException</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a id="cloneStream(java.io.InputStream,boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cloneStream</h4>
<pre class="methodSignature">public final&nbsp;jetbrains.exodus.util.ByteArraySizedInputStream&nbsp;cloneStream&#8203;(@NotNull
                                                                         @NotNull java.io.InputStream&nbsp;source,
                                                                         boolean&nbsp;closeSource)
                                                                  throws java.io.IOException</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a id="getFileStream(java.io.File)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFileStream</h4>
<pre class="methodSignature">public final&nbsp;java.io.BufferedInputStream&nbsp;getFileStream&#8203;(@NotNull
                                                       @NotNull java.io.File&nbsp;file)
                                                throws java.io.IOException</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
<a id="cloneFile(java.io.File)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>cloneFile</h4>
<pre class="methodSignature">public final&nbsp;jetbrains.exodus.util.ByteArraySizedInputStream&nbsp;cloneFile&#8203;(@NotNull
                                                                       @NotNull java.io.File&nbsp;file)
                                                                throws java.io.IOException</pre>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
